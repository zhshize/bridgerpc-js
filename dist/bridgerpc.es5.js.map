{"version":3,"file":"bridgerpc.es5.js","sources":["../src/rpcRequest.ts","../src/rpcResponse.ts","../src/rpcError.ts","../src/operationTimeoutError.ts","../src/bridgerpc.ts"],"sourcesContent":["import msgpack from 'msgpack-lite'\r\n\r\nexport default class RpcRequest {\r\n  public bridgerpc: string = '1.0'\r\n  public id: string | null = null\r\n  public method: string = ''\r\n  public data: any = null\r\n\r\n  public encodeToMessagePack(): any {\r\n    return msgpack.encode({\r\n      bridgerpc: this.bridgerpc,\r\n      id: this.id,\r\n      method: this.method,\r\n      data: this.data\r\n    })\r\n  }\r\n}\r\n","import RpcError from './rpcError'\r\nimport msgpack from 'msgpack-lite'\r\n\r\nexport default class RpcResponse {\r\n  public bridgerpc: string = '1.0'\r\n  public id: string | null = null\r\n  public result: any = null\r\n  public error: RpcError | null = null\r\n\r\n  public encodeToMessagePack(): any {\r\n    const r: any = {\r\n      bridgerpc: this.bridgerpc,\r\n      id: this.id,\r\n      result: this.result,\r\n      error: null\r\n    }\r\n    if (this.error !== null || this.error !== undefined) {\r\n      const error = this.error as RpcError\r\n      r.error = {\r\n        code: error.code,\r\n        message: error.message,\r\n        data: error.data\r\n      }\r\n    }\r\n    return msgpack.encode(r)\r\n  }\r\n}\r\n","export default class RpcError {\r\n  public code: number = 0\r\n  public message: string = ''\r\n  public data: any = null\r\n}\r\n","export default class OperationTimeoutError extends Error {}\r\n","// Import here Polyfills if needed. Recommended core-js (npm i -D core-js)\n// ...\n// @ts-ignore\nimport RpcRequest from './rpcRequest'\nimport RpcResponse from './rpcResponse'\nimport msgpack from 'msgpack-lite'\nimport RpcError from './rpcError'\nimport OperationTimeoutError from './operationTimeoutError'\n\nexport { RpcRequest, RpcResponse, RpcError, OperationTimeoutError }\n\n/**\n * RPC Request handler must process a request and return a [[RpcResponse]].\n */\nexport type RpcHandler = (request: RpcRequest) => any\n\n/**\n * RPC Notification handler must process a request, nothing should be returned.\n */\nexport type RpcNotificationHandler = (request: RpcRequest) => void\n\n/**\n * [[BridgeRpc]] is an Bridge RPC client can connect to Bridge RPC server and\n * register methods and emit a request or a notification.\n */\nexport default class BridgeRpc {\n  /**\n   * Initialize an [[BridgeRpc]] object, start receiving/sending after called\n   * [[connect]].  Suggest you register the handling methods before you call\n   * [[connect]].\n   * @param url Url of the server to be connected.\n   */\n  public constructor(url: string) {\n    this.url = url\n    this.handlers = new RequestHandlerDictionary()\n    this.notificationHandlers = new NotificationHandlerDictionary()\n    this.callbacks = new CallbackDictionary()\n  }\n\n  protected _rawSocket: WebSocket | null = null\n  protected url: string\n  protected handlers: RequestHandlerDictionary\n  protected notificationHandlers: NotificationHandlerDictionary\n  protected callbacks: CallbackDictionary\n\n  /**\n   * Get [[WebSocket]] object maintained by [[BridgeRpc]] object.\n   * **BE CAREFUL** to access this getter.\n   */\n  get rawSocket(): WebSocket {\n    if (this._rawSocket === null) {\n      this.connect()\n    }\n    return this._rawSocket as WebSocket\n  }\n\n  /**\n   * Connect to the server.\n   * Suggest you register the handling methods before you call [[connect]].\n   */\n  public connect() {\n    this._rawSocket = new WebSocket(this.url)\n    this._rawSocket.binaryType = 'arraybuffer'\n    this._rawSocket.onmessage = this.onMessage.bind(this)\n  }\n\n  /**\n   * An event listener to be called when the server is connected.\n   * @param connected The event listener.\n   */\n  public onConnect(connected: () => void): void {\n    this.rawSocket.onopen = connected\n  }\n\n  /**\n   * An event listener with method name to be called when received a request.\n   * @param method The name of the method will be registered.\n   * @param handler The event listener, must returned a [[RpcResponse]].\n   */\n  public onRequest(method: string, handler: RpcHandler): void {\n    this.handlers[method] = handler\n  }\n\n  /**\n   * An event listener with method name to be called when received a notification.\n   * @param method The name of the method will be registered.\n   * @param handler The event listener, no return value.\n   */\n  public onNotify(method: string, handler: RpcNotificationHandler): void {\n    const m = this.notificationHandlers[method]\n    if (m === null || m === undefined) {\n      this.notificationHandlers[method] = new Array<RpcHandler>()\n    }\n    this.notificationHandlers[method].push(handler)\n  }\n\n  /**\n   * Call remote method.\n   * @param method The method name to be called.\n   * @param data Parameters to be sent.\n   * @param timeoutMilliSeconds Timeout of request operation, unit is millisecond.\n   */\n  public request(\n    method: string,\n    data: any,\n    timeoutMilliSeconds: number = 5000\n  ): Promise<RpcResponse> {\n    const id = BridgeRpc.randomString()\n    this.rawSocket.send(\n      msgpack.encode({\n        bridgerpc: '1.0',\n        method: method,\n        data: data,\n        id: id\n      })\n    )\n    return new Promise<RpcResponse>((resolve, reject) => {\n      this.callbacks[id] = new RpcCallback(resolve, reject)\n      setTimeout(() => {\n        if (this.callbacks.hasOwnProperty(id)) {\n          this.callbacks[id].reject(\n            new OperationTimeoutError(`Rpc request timeout (${timeoutMilliSeconds} ms)`)\n          )\n        }\n      }, timeoutMilliSeconds)\n    })\n  }\n\n  /**\n   * Call remote method without response.\n   * @param method The method name to be called.\n   * @param data Parameters to be sent.\n   */\n  public notify(method: string, data: any): void {\n    this.rawSocket.send(\n      msgpack.encode({\n        bridgerpc: '1.0',\n        method: method,\n        data: data,\n        id: null\n      })\n    )\n  }\n\n  /**\n   * An event listener for [[WebSocket]] onmessage to handle BridgeRpc message.\n   * @param event Event object from WebSocket.onmessage\n   */\n  protected onMessage(event: any) {\n    const data = msgpack.decode(new Uint8Array(event.data))\n    if (data.method !== undefined && data.method !== null) {\n      // It's a request or notification\n      if (data.id !== undefined && data.id !== null) {\n        // It's a request\n        const request = data as RpcRequest\n        const handler = this.handlers[request.method]\n        if (handler === null || handler === undefined) {\n          // Method not found\n          this.rawSocket.send(BridgeRpc.methodNotFoundResponse(request).encodeToMessagePack())\n          return\n        }\n        let res: any\n        try {\n          res = handler(request)\n          if (!(res instanceof RpcResponse)) {\n            let generateResponse = new RpcResponse()\n            generateResponse.id = request.id\n            generateResponse.result = res\n            res = generateResponse\n          }\n          if (res === undefined || res === null) {\n            // Internal Error\n            this.rawSocket.send(\n              BridgeRpc.internalErrorResponse(\n                request,\n                'Method called, but no response.',\n                null\n              ).encodeToMessagePack()\n            )\n            return\n          }\n        } catch (e) {\n          // Internal Error\n          this.rawSocket.send(\n            BridgeRpc.internalErrorResponse(\n              request,\n              'Error occurred when method calling.',\n              e\n            ).encodeToMessagePack()\n          )\n          return\n        }\n        const response = res as RpcResponse\n        response.id = request.id\n        this.rawSocket.send(response.encodeToMessagePack())\n      } else {\n        // It's a notification\n        const notification = data as RpcRequest\n        const handlers = this.handlers[notification.method]\n        if (handlers.length === 0) {\n          // Method not found (should NOT sent response)\n        }\n        try {\n          this.notificationHandlers[notification.method].forEach(handler => {\n            handler(data)\n          })\n        } catch (e) {\n          // ignore\n        }\n      }\n    } else {\n      // It's a response\n      const response = data as RpcResponse\n      const callback = this.callbacks[response.id as string]\n      try {\n        callback.resolve(response)\n        delete this.callbacks[response.id as string]\n      } catch (e) {\n        // ignore\n      }\n    }\n  }\n\n  /**\n   * Close the connection.\n   * @param code A numeric value indicating the status code explaining why the connection is being\n   * closed. If this parameter is not specified, a default value of 1005 is assumed. See the [list\n   * of status codes](https://developer.mozilla.org/en-US/docs/Web/API/CloseEvent#Status_codes)\n   * of CloseEvent for permitted values.\n   * @param reason A human-readable string explaining why the connection is closing. This string\n   * must be no longer than 123 bytes of UTF-8 text (**not** characters).\n   */\n  public close(code: number, reason: string): void {\n    this.rawSocket.close(code, reason)\n  }\n\n  protected static methodNotFoundResponse(request: RpcRequest): RpcResponse {\n    const error = new RpcError()\n    error.code = -3\n    error.message = 'Method not found.'\n    error.data = request\n    const response = new RpcResponse()\n    response.error = error\n    response.result = null\n    response.id = request.id\n    return response\n  }\n\n  protected static internalErrorResponse(\n    request: RpcRequest,\n    message: string,\n    error: any\n  ): RpcResponse {\n    const err = new RpcError()\n    err.code = -10\n    err.message = message\n    err.data = error\n    const response = new RpcResponse()\n    response.error = err\n    response.result = null\n    response.id = request.id\n    return response\n  }\n\n  protected static randomString(): string {\n    return (\n      Math.random()\n        .toString(36)\n        .substring(2, 10) +\n      Math.random()\n        .toString(36)\n        .substring(2, 10)\n    )\n  }\n}\n\nclass RequestHandlerDictionary {\n  [index: string]: RpcHandler\n}\n\nclass NotificationHandlerDictionary {\n  [index: string]: RpcNotificationHandler[]\n}\n\nclass RpcCallback {\n  public constructor(resolve: (response: RpcResponse) => void, reject: (reason: any) => void) {\n    this.resolve = resolve\n    this.reject = reject\n  }\n\n  public resolve: (response: RpcResponse) => void\n  public reject: (reason: any) => void\n  /*public call(response: RpcResponse) {\n    try {\n      this.resolve(response);\n    } catch (e) {\n      this.reject(e);\n    }\n  }*/\n}\n\nclass CallbackDictionary {\n  [index: string]: RpcCallback\n}\n"],"names":["tslib_1.__extends"],"mappings":"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"}